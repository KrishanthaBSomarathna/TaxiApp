# Firebase Booking Structure

## Overview
The TaxiApp stores booking confirmations in Firebase Realtime Database at the path `/bookings/{bookingId}` with the exact structure specified.

## Firebase Path
```
/bookings/{bookingId}
```

## Data Structure
Each booking document contains the following fields:

| Field | Type | Description | Example |
|-------|------|-------------|---------|
| `userId` | String | Unique Firebase Auth user ID | "abc123" |
| `userName` | String | Full name of the user | "John Doe" |
| `userPhone` | String | User's phone number | "+911234567890" |
| `userLat` | Double | User's current latitude | 13.065400 |
| `userLng` | Double | User's current longitude | 80.233900 |
| `driverName` | String | Name of the assigned driver | "Driver A" |
| `driverLat` | Double | Driver's current latitude | 13.068500 |
| `driverLng` | Double | Driver's current longitude | 80.234938 |
| `destinationLat` | Double | Destination latitude | 13.075000 |
| `destinationLng` | Double | Destination longitude | 80.240000 |
| `destinationAddress` | String | Human-readable destination address | "No.10, XYZ Street, Chennai" |
| `tripDateTime` | String | Scheduled trip date and time (ISO format) | "2025-08-13T09:30:00" |
| `paymentType` | String | Payment method selected | "Credit Card" or "Cash" |
| `bookingDateTime` | String | When the booking was created (ISO format) | "2025-08-12T14:15:30" |

## Implementation Details

### 1. Data Collection
- **User Data**: Retrieved from Firebase Auth and user profile
- **Driver Data**: Passed from previous activity (driver selection)
- **Destination Data**: Collected from destination selection activity
- **Trip DateTime**: Selected by user using date/time pickers
- **Payment Type**: Selected by user (Cash or Credit Card)
- **Booking DateTime**: Automatically generated when booking is confirmed

### 2. Validation
The app validates all required fields before storing to Firebase:
- All string fields must not be blank
- Coordinate fields must not be 0.0
- Date/time fields must be in proper format

### 3. Firebase Storage
- Uses Firebase Realtime Database
- Generates unique booking ID using `push().key`
- Stores at path: `/bookings/{autoGeneratedId}`
- Includes error handling and success callbacks

### 4. Data Format
- **Coordinates**: Stored as Double values
- **Date/Time**: Stored in ISO 8601 format (YYYY-MM-DDTHH:mm:ss)
- **Phone Numbers**: Stored as strings with country code
- **Payment Types**: Limited to "Cash" or "Credit Card"

## Example Firebase Document
```json
{
  "userId": "abc123",
  "userName": "John Doe",
  "userPhone": "+911234567890",
  "userLat": 13.065400,
  "userLng": 80.233900,
  "driverName": "Driver A",
  "driverLat": 13.068500,
  "driverLng": 80.234938,
  "destinationLat": 13.075000,
  "destinationLng": 80.240000,
  "destinationAddress": "No.10, XYZ Street, Chennai",
  "tripDateTime": "2025-08-13T09:30:00",
  "paymentType": "Credit Card",
  "bookingDateTime": "2025-08-12T14:15:30"
}
```

## Security Rules
Ensure your Firebase security rules allow authenticated users to read/write their own bookings:

```json
{
  "rules": {
    "bookings": {
      "$bookingId": {
        ".read": "auth != null && data.child('userId').val() == auth.uid",
        ".write": "auth != null && (!data.exists() || data.child('userId').val() == auth.uid)"
      }
    }
  }
}
```

## Testing
To verify the implementation:
1. Check Android Logcat for "BookingActivity" logs
2. Verify data in Firebase Console
3. Ensure all required fields are populated
4. Check coordinate accuracy
5. Verify date/time format consistency
